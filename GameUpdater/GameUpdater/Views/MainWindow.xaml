<Window x:Class="GameUpdater.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:GameUpdater.Views"
        xmlns:converters="clr-namespace:GameUpdater.Converters"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        mc:Ignorable="d"
        Title="Gunz Online Launcher"
        Width="950" Height="580"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="NoResize"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <converters:StringToVisibilityConverter x:Key="StringToVisibilityConverter"/>
    </Window.Resources>

    <!-- Main Window Container with Dark Gradient -->
    <Border CornerRadius="10"
            BorderBrush="#1A2D42"
            BorderThickness="1">
        <Border.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                <GradientStop Color="#0A1218" Offset="0"/>
                <GradientStop Color="#050A10" Offset="1"/>
            </LinearGradientBrush>
        </Border.Background>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="52"/>    <!-- Header -->
                <RowDefinition Height="*"/>     <!-- Content -->
                <RowDefinition Height="72"/>    <!-- Footer -->
            </Grid.RowDefinitions>

            <!-- ========================== HEADER ========================== -->
            <Border Grid.Row="0"
                    CornerRadius="10,10,0,0"
                    x:Name="TitleBar"
                    MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#0E1620" Offset="0"/>
                        <GradientStop Color="#080E16" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>

                <Grid Margin="16,0">
                    <!-- Logo and Title -->
                    <StackPanel Orientation="Horizontal"
                                VerticalAlignment="Center"
                                HorizontalAlignment="Left">
                        <!-- Logo Icon -->
                        <Path Data="{StaticResource LogoIcon}"
                              Fill="#2196F3"
                              Width="24" Height="24"
                              Stretch="Uniform"/>

                        <TextBlock Text="GUNZ ONLINE"
                                   FontFamily="Segoe UI"
                                   FontSize="15"
                                   FontWeight="Bold"
                                   Foreground="#FFFFFF"
                                   Margin="10,0,0,0"
                                   VerticalAlignment="Center"/>
                    </StackPanel>

                    <!-- Right Side - Social + Window Controls -->
                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center">

                        <!-- Social Media Label -->
                        <TextBlock Text="FOLLOW US"
                                   Foreground="#4A5568"
                                   FontSize="10"
                                   FontWeight="SemiBold"
                                   VerticalAlignment="Center"
                                   Margin="0,0,10,0"/>

                        <Button Style="{StaticResource SocialButtonStyle}"
                                Command="{Binding OpenInstagramCommand}"
                                ToolTip="Instagram"
                                Margin="0,0,4,0">
                            <Path Data="{StaticResource InstagramIcon}"
                                  Fill="#A0AEC0"
                                  Width="14" Height="14"
                                  Stretch="Uniform"/>
                        </Button>

                        <Button Style="{StaticResource SocialButtonStyle}"
                                Command="{Binding OpenTwitterCommand}"
                                ToolTip="Twitter"
                                Margin="0,0,4,0">
                            <Path Data="{StaticResource TwitterIcon}"
                                  Fill="#A0AEC0"
                                  Width="14" Height="14"
                                  Stretch="Uniform"/>
                        </Button>

                        <Button Style="{StaticResource SocialButtonStyle}"
                                Command="{Binding OpenDiscordCommand}"
                                ToolTip="Discord"
                                Margin="0,0,16,0">
                            <Path Data="{StaticResource DiscordIcon}"
                                  Fill="#A0AEC0"
                                  Width="14" Height="14"
                                  Stretch="Uniform"/>
                        </Button>

                        <!-- Separator -->
                        <Rectangle Width="1" Height="20" Fill="#1A2D42" Margin="0,0,10,0"/>

                        <!-- Window Controls -->
                        <Button Style="{StaticResource WindowButtonStyle}"
                                Command="{Binding MinimizeCommand}"
                                ToolTip="Minimize"
                                Margin="0,0,2,0">
                            <Path Data="{StaticResource MinimizeIcon}"
                                  Stroke="#A0AEC0"
                                  StrokeThickness="2"
                                  Width="10" Height="10"
                                  Stretch="Uniform"/>
                        </Button>

                        <Button Style="{StaticResource CloseButtonStyle}"
                                Command="{Binding CloseCommand}"
                                ToolTip="Close">
                            <Path Data="{StaticResource CloseIcon}"
                                  Fill="#A0AEC0"
                                  Width="10" Height="10"
                                  Stretch="Uniform"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- ========================== MAIN CONTENT ========================== -->
            <Grid Grid.Row="1" Margin="16,12,16,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="320"/>   <!-- Left: News -->
                    <ColumnDefinition Width="12"/>    <!-- Spacing -->
                    <ColumnDefinition Width="*"/>     <!-- Right: Web Content -->
                </Grid.ColumnDefinitions>

                <!-- Left Side - News Panel -->
                <Border Grid.Column="0"
                        CornerRadius="8"
                        BorderBrush="#1A2D42"
                        BorderThickness="1">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#0C1620" Offset="0"/>
                            <GradientStop Color="#081018" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>

                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- News Header -->
                        <Border Grid.Row="0"
                                Padding="14,12"
                                BorderBrush="#1A2D42"
                                BorderThickness="0,0,0,1">
                            <TextBlock Text="LAST NEWS"
                                       FontFamily="Segoe UI"
                                       FontSize="11"
                                       FontWeight="SemiBold"
                                       Foreground="#4A5568"/>
                        </Border>

                        <!-- News List -->
                        <ScrollViewer Grid.Row="1"
                                      VerticalScrollBarVisibility="Auto"
                                      Style="{StaticResource ModernScrollViewerStyle}"
                                      Padding="10,8,10,10">
                            <ItemsControl ItemsSource="{Binding NewsItems}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Margin="0,0,0,6"
                                                Padding="10"
                                                CornerRadius="6"
                                                Cursor="Hand"
                                                BorderBrush="#1A2D42"
                                                BorderThickness="1">
                                            <Border.Background>
                                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                    <GradientStop Color="#0E1822" Offset="0"/>
                                                    <GradientStop Color="#0A1218" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.Background>

                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="32"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <!-- News Icon -->
                                                <Border Grid.Column="0"
                                                        Width="26" Height="26"
                                                        CornerRadius="5"
                                                        Background="#2196F3"
                                                        VerticalAlignment="Top">
                                                    <Path Data="{StaticResource LogoIcon}"
                                                          Fill="White"
                                                          Width="12" Height="12"
                                                          Stretch="Uniform"
                                                          HorizontalAlignment="Center"
                                                          VerticalAlignment="Center"/>
                                                </Border>

                                                <!-- News Content -->
                                                <StackPanel Grid.Column="1" Margin="8,0,0,0">
                                                    <TextBlock Text="{Binding Title}"
                                                               FontFamily="Segoe UI"
                                                               FontSize="12"
                                                               FontWeight="SemiBold"
                                                               Foreground="#FFFFFF"
                                                               TextWrapping="Wrap"/>
                                                    <TextBlock Text="{Binding Summary}"
                                                               FontFamily="Segoe UI"
                                                               FontSize="11"
                                                               Foreground="#4A5568"
                                                               TextWrapping="Wrap"
                                                               Margin="0,3,0,0"
                                                               MaxHeight="36"
                                                               TextTrimming="CharacterEllipsis"/>
                                                    <TextBlock Text="{Binding FormattedDate}"
                                                               FontFamily="Segoe UI"
                                                               FontSize="10"
                                                               Foreground="#3A4A5A"
                                                               Margin="0,4,0,0"/>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </Grid>
                </Border>

                <!-- Right Side - Web Content -->
                <Border Grid.Column="2"
                        CornerRadius="8"
                        BorderBrush="#1A2D42"
                        BorderThickness="1"
                        ClipToBounds="True">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#0C1620" Offset="0"/>
                            <GradientStop Color="#081018" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>

                    <Grid>
                        <!-- WebView2 for dynamic content -->
                        <wv2:WebView2 x:Name="ContentBrowser"
                                      DefaultBackgroundColor="#0A1218"/>

                        <!-- Fallback placeholder -->
                        <StackPanel x:Name="FallbackContent"
                                    VerticalAlignment="Center"
                                    HorizontalAlignment="Center"
                                    Visibility="Collapsed">
                            <Path Data="{StaticResource LogoIcon}"
                                  Fill="#2196F3"
                                  Width="64" Height="64"
                                  Stretch="Uniform"
                                  Opacity="0.3"/>
                            <TextBlock Text="GUNZ ONLINE"
                                       FontSize="20"
                                       FontWeight="Bold"
                                       Foreground="#FFFFFF"
                                       HorizontalAlignment="Center"
                                       Margin="0,12,0,0"
                                       Opacity="0.3"/>
                            <TextBlock Text="Welcome to the battlefield"
                                       FontSize="11"
                                       Foreground="#4A5568"
                                       HorizontalAlignment="Center"
                                       Margin="0,4,0,0"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>

            <!-- ========================== FOOTER ========================== -->
            <Border Grid.Row="2"
                    CornerRadius="0,0,10,10">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#0C1418" Offset="0"/>
                        <GradientStop Color="#060A10" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>

                <Grid Margin="16,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Left Side - Status and Progress -->
                    <StackPanel Grid.Column="0" VerticalAlignment="Center">
                        <!-- Status Row -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                            <TextBlock Text="{Binding StatusText}"
                                       FontFamily="Segoe UI"
                                       FontSize="11"
                                       Foreground="#A0AEC0"/>
                            <TextBlock Text="{Binding DownloadSpeedText}"
                                       FontFamily="Segoe UI"
                                       FontSize="11"
                                       FontWeight="SemiBold"
                                       Foreground="#2196F3"
                                       Margin="16,0,0,0"
                                       Visibility="{Binding IsUpdating, Converter={StaticResource BoolToVisibilityConverter}}"/>
                        </StackPanel>

                        <!-- Progress Bar (visible during update) -->
                        <Grid Width="480" HorizontalAlignment="Left"
                              Visibility="{Binding IsUpdating, Converter={StaticResource BoolToVisibilityConverter}}">
                            <ProgressBar Style="{StaticResource GlowingProgressBarStyle}"
                                         Value="{Binding OverallProgress}"
                                         Height="6"/>
                        </Grid>

                        <!-- Ready Progress (when not updating) -->
                        <Grid Width="480" HorizontalAlignment="Left"
                              Visibility="{Binding IsUpdating, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Invert}">
                            <ProgressBar Style="{StaticResource SlimProgressBarStyle}"
                                         Value="100"
                                         Height="4"
                                         Visibility="{Binding IsInitializing, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Invert}"/>
                        </Grid>
                    </StackPanel>

                    <!-- Right Side - CONNECT Button -->
                    <Button Grid.Column="1"
                            Style="{StaticResource PlayButtonStyle}"
                            Content="CONNECT"
                            Command="{Binding LaunchGameCommand}"
                            IsEnabled="{Binding CanLaunchGame}"
                            VerticalAlignment="Center"/>
                </Grid>
            </Border>
        </Grid>
    </Border>
</Window>
